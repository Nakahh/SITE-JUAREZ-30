<!doctype html>
<html>
  <head>
    <title>Cache Cleared</title>
    <meta
      http-equiv="Cache-Control"
      content="no-cache, no-store, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
  </head>
  <body>
    <h1>Clearing all caches...</h1>
    <script>
      // Aggressive cache clearing
      (async function () {
        console.log("Starting aggressive cache clear...");

        // Clear service workers
        if ("serviceWorker" in navigator) {
          const registrations =
            await navigator.serviceWorker.getRegistrations();
          for (let registration of registrations) {
            await registration.unregister();
            console.log("Service worker unregistered");
          }
        }

        // Clear all caches
        if ("caches" in window) {
          const cacheNames = await caches.keys();
          for (let name of cacheNames) {
            await caches.delete(name);
            console.log("Cache deleted:", name);
          }
        }

        // Clear storage
        try {
          localStorage.clear();
          sessionStorage.clear();

          // Clear IndexedDB
          if ("indexedDB" in window) {
            const databases = await indexedDB.databases();
            for (let db of databases) {
              indexedDB.deleteDatabase(db.name);
            }
          }
        } catch (e) {
          console.log("Storage clear error:", e);
        }

        console.log("Cache clearing complete");

        // Redirect to home after clearing
        setTimeout(() => {
          window.location.href = "/";
        }, 2000);
      })();
    </script>
  </body>
</html>
